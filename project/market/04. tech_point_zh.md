# Tampines é¡¹ç›®é¢è¯•å‡†å¤‡æ–‡æ¡£ - æŠ€æœ¯è¦ç‚¹é€ŸæŸ¥è¡¨

## ğŸ“Š é¡¹ç›®æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡é¡¹              | æ•°å€¼                                      |
| ------------------- | ----------------------------------------- |
| **é¡¹ç›®åç§°**        | Tampines å®æ—¶é‡‘èå¸‚åœºæ•°æ®å¤„ç†ç³»ç»Ÿ         |
| **æ ¸å¿ƒæŠ€æœ¯**        | Apache Flink 1.17.2 + Kafka 3.1.2 + Redis |
| **æ¨¡å—æ•°é‡**        | 3ä¸ªï¼ˆcommonã€flinkã€outerï¼‰               |
| **Flink Job æ•°é‡**  | 3ä¸ªï¼ˆOrderbookJobã€TickerJobã€CandleJobï¼‰ |
| **æ•°æ®å»¶è¿Ÿ**        | æ¯«ç§’çº§ï¼ˆ<100msï¼‰                          |
| **å¹¶è¡Œåº¦**          | 1ï¼ˆå¼€å‘ç¯å¢ƒï¼Œç”Ÿäº§å¯æ‰©å±•è‡³32+ï¼‰            |
| **çŠ¶æ€åç«¯**        | RocksDB                                   |
| **Checkpoint é—´éš”** | 60 ç§’                                     |
| **æ•°æ®ç²¾åº¦**        | BigDecimalï¼ˆé‡‘èçº§ï¼‰                      |
| **è®¢å•ç°¿åˆ†è¾¨ç‡**    | 1ã€5ã€10ã€100 å€ tickSize                 |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„é€ŸæŸ¥

### ä¸‰å±‚æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  market-outer   â”‚  WebSocket æ•°æ®æ¥å…¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Kafka Topics
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  market-flink   â”‚  Flink æµå¤„ç†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Redis
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ market-common   â”‚  å…¬å…±åŸºç¡€ç»„ä»¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµå‘
```
å¤–éƒ¨äº¤æ˜“æ‰€ â†’ WebSocket â†’ market-outer â†’ Kafka â†’ Flink Jobs â†’ Redis â†’ å‰ç«¯/API
```

### Kafka Topics
- `order` - è®¢å•æ•°æ®
- `trade` - äº¤æ˜“æ•°æ®  
- `quote` - è¡Œæƒ…æ•°æ®

### Redis Keys
- `orderbook:{resolution}:{contractId}` - è®¢å•ç°¿
- `ticker:{contractId}` - 24å°æ—¶è¡Œæƒ…
- `candle:{period}:{contractId}` - Kçº¿æ•°æ®

---

## ğŸ’» æ ¸å¿ƒä»£ç é€ŸæŸ¥

### OrderBookProcessor å…³é”®æ–¹æ³•

#### 1. çŠ¶æ€åˆå§‹åŒ–
```java
MapState<BigDecimal, BigDecimal> bidState;  // ä¹°ç›˜
MapState<BigDecimal, BigDecimal> askState;  // å–ç›˜
```

#### 2. è®¢å•å¤„ç†
```java
processElement(Order order, Context ctx, Collector<OrderBook> out)
â”œâ”€ ä»·æ ¼åˆ†ç»„: groupedPrice = groupPrice(price, grouping)
â”œâ”€ é€‰æ‹©çŠ¶æ€: sideState = (BID) ? bidState : askState
â”œâ”€ æ›´æ–°çŠ¶æ€:
â”‚  â”œâ”€ INSERT: sideState.put(price, currentQty + newQty)
â”‚  â””â”€ DELETE: sideState.remove(price) or update(price, currentQty - qty)
â””â”€ æ³¨å†Œå®šæ—¶å™¨: timer = currentTime + 1000ms
```

#### 3. å®šæ—¶å™¨è§¦å‘
```java
onTimer(long timestamp, OnTimerContext ctx, Collector<OrderBook> out)
â”œâ”€ éå† bidState.entries() â†’ orderBook.getBids()
â”œâ”€ éå† askState.entries() â†’ orderBook.getAsks()
â”œâ”€ è®¾ç½®å…ƒæ•°æ®: contractId, grouping, market
â””â”€ è¾“å‡º: out.collect(orderBook)
```

#### 4. ä»·æ ¼åˆ†ç»„ç®—æ³•
```java
groupPrice(BigDecimal price, double grouping)
  = floor(price / grouping) * grouping
  
ç¤ºä¾‹: price=100.23, grouping=2.5
     â†’ floor(100.23 / 2.5) * 2.5 = 100.0
```

### TickerJob å…³é”®é…ç½®
```java
keyedStream
  .window(SlidingEventTimeWindows.of(
    Time.hours(24),    // çª—å£å¤§å°
    Time.seconds(1)))  // æ»‘åŠ¨æ­¥é•¿
  .aggregate(new TickerAggregator(), new TickerProcessor())
  .addSink(new TickerSink())
```

---

## ğŸ”§ Flink æ ¸å¿ƒçŸ¥è¯†é€ŸæŸ¥

### State ç±»å‹å¯¹æ¯”

| State ç±»å‹           | ç‰¹ç‚¹              | é¡¹ç›®ä¸­çš„ä½¿ç”¨                   |
| -------------------- | ----------------- | ------------------------------ |
| **MapState<K, V>**   | Mapç»“æ„ï¼Œé«˜æ•ˆæŸ¥è¯¢ | âœ… OrderBookProcessorï¼ˆä¹°å–ç›˜ï¼‰ |
| **ValueState<T>**    | å•å€¼å­˜å‚¨          | å¯ç”¨äºå»é‡ï¼ˆlastSeenIdï¼‰       |
| **ListState<T>**     | åˆ—è¡¨å­˜å‚¨          | æœªä½¿ç”¨                         |
| **ReducingState<T>** | ç´¯åŠ èšåˆ          | æœªä½¿ç”¨                         |
| **AggregatingState** | å¤æ‚èšåˆ          | TickerAggregator å†…ç½®          |

### Checkpoint æœºåˆ¶

```
1. JobManager æ³¨å…¥ Barrier
   â†“
2. Barrier éšæ•°æ®æµä¼ æ’­
   â†“
3. ç®—å­æ”¶åˆ° Barrier æ—¶ä¿å­˜çŠ¶æ€å¿«ç…§
   â†“
4. å¿«ç…§æŒä¹…åŒ–åˆ°å¤–éƒ¨å­˜å‚¨ï¼ˆHDFS/S3ï¼‰
   â†“
5. æ‰€æœ‰ç®—å­å®Œæˆ â†’ Checkpoint æˆåŠŸ
   â†“
6. Kafka Offset ä¹Ÿè¢«ä¿å­˜
   â†“
å¤±è´¥æ—¶ä»æœ€è¿‘çš„ Checkpoint æ¢å¤
```

### Exactly-Once å®ç°

| å±‚æ¬¡       | å®ç°æ–¹å¼                                   |
| ---------- | ------------------------------------------ |
| **Source** | Kafka æ‰‹åŠ¨ç®¡ç† Offsetï¼ŒCheckpoint è®°å½•ä½ç½® |
| **è®¡ç®—**   | Barrier å¯¹é½ + State å¿«ç…§                  |
| **Sink**   | Redis SET å¹‚ç­‰å†™å…¥                         |

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–é€ŸæŸ¥

### ä¼˜åŒ–æ‰‹æ®µï¼ˆ6å¤§ç±»ï¼‰

#### 1. å¹¶è¡Œåº¦ä¼˜åŒ–
```java
// ä¸åŒç®—å­ä¸åŒå¹¶è¡Œåº¦
source.setParallelism(4)
  .process(...).setParallelism(2)
  .addSink(...).setParallelism(4)
```

#### 2. çŠ¶æ€ä¼˜åŒ–
```java
// RocksDB StateBackend
see.setStateBackend(new RocksDBStateBackend("hdfs://..."));

// å¢é‡ Checkpoint
see.getCheckpointConfig().enableIncrementalCheckpoints(true);

// State TTL
StateTtlConfig.newBuilder(Time.days(1)).build();
```

#### 3. ç½‘ç»œä¼˜åŒ–
```java
see.getConfig().setNetworkBufferTimeout(100);  // 100ms
```

#### 4. ç®—å­é“¾ä¼˜åŒ–
```java
see.disableOperatorChaining();  // è°ƒè¯•æ—¶
stream.map(...).startNewChain();  // å¼ºåˆ¶æ–­å¼€
```

#### 5. æ•°æ®å€¾æ–œå¤„ç†
```java
// å¢åŠ éšæœºå‰ç¼€ â†’ ä¸¤é˜¶æ®µèšåˆ
.map(data -> (random + "_" + key, data))
.keyBy(0).reduce(...)
.map(data -> (key, data))
.keyBy(0).reduce(...)
```

#### 6. å¼‚æ­¥ IO
```java
AsyncDataStream.unorderedWait(
  stream,
  new AsyncRedisFunction(),
  1000, TimeUnit.MILLISECONDS,
  100  // å¼‚æ­¥å®¹é‡
)
```

### é¡¹ç›®ä¸­çš„ä¼˜åŒ–å®è·µ
1. âœ… **ä»·æ ¼åˆ†ç»„ç®—æ³•** - å‡å°‘çŠ¶æ€æ•°é‡
2. âœ… **åˆ é™¤æ•°é‡ä¸º0çš„æ¡£ä½** - é¿å…çŠ¶æ€ç´¯ç§¯
3. âœ… **RocksDB StateBackend** - æ”¯æŒå¤§çŠ¶æ€
4. ğŸ”² å¼‚æ­¥ Redis å†™å…¥ï¼ˆå¯ä¼˜åŒ–ï¼‰
5. ğŸ”² å¢é‡è¾“å‡ºï¼ˆå¯ä¼˜åŒ–ï¼‰

---

## ğŸ› æ•…éšœæ’æŸ¥é€ŸæŸ¥

### è®¢å•ç°¿ä¸æ›´æ–° - æ’æŸ¥æµç¨‹
```
1. ç¡®è®¤ç°è±¡
   redis-cli GET orderbook:1:1  # æ£€æŸ¥æ—¶é—´æˆ³

2. æ£€æŸ¥ Flink ä½œä¸š
   http://localhost:8081  # Web UI

3. æŸ¥çœ‹æ—¥å¿—
   tail -f flink-*-taskexecutor-*.log
   grep "ERROR" *.log

4. æ£€æŸ¥ Kafka æ¶ˆè´¹
   kafka-consumer-groups.sh --describe --group orderbook

5. æ£€æŸ¥ market-outer
   tail -f market-outer.log

6. æ£€æŸ¥ä¾èµ–æœåŠ¡
   redis-cli PING
   kafka-broker-api-versions.sh --bootstrap-server localhost:9092
```

### å¸¸è§æ•…éšœåŸå› 

| æ•…éšœç°è±¡           | å¯èƒ½åŸå›       | è§£å†³æ–¹æ¡ˆ                    |
| ------------------ | ------------- | --------------------------- |
| **è®¢å•ç°¿ä¸æ›´æ–°**   | Flinkä½œä¸šæŒ‚æ‰ | æ£€æŸ¥æ—¥å¿—ï¼Œé‡å¯ä½œä¸š          |
|                    | Kafkaè¿æ¥æ–­å¼€ | é‡å¯Kafkaï¼Œæ£€æŸ¥ç½‘ç»œ         |
|                    | WebSocketæ–­çº¿ | market-outeré‡å¯            |
| **å†…å­˜OOM**        | Stateè¿‡å¤§     | å¢åŠ å†…å­˜/RocksDB/Stateæ¸…ç†  |
| **å¤„ç†å»¶è¿Ÿé«˜**     | æ•°æ®å€¾æ–œ      | å¢åŠ éšæœºå‰ç¼€/è‡ªå®šä¹‰åˆ†åŒº     |
|                    | å¹¶è¡Œåº¦ä¸è¶³    | å¢åŠ å¹¶è¡Œåº¦                  |
| **Checkpointå¤±è´¥** | è¶…æ—¶          | å¢åŠ è¶…æ—¶æ—¶é—´/å¢é‡Checkpoint |
|                    | ç£ç›˜æ»¡        | æ¸…ç†ç£ç›˜/æ‰©å®¹               |
| **Rediså†™å…¥å¤±è´¥**  | è¿æ¥æ•°æ»¡      | å¢åŠ è¿æ¥æ± /é‡è¯•æœºåˆ¶         |
|                    | å†…å­˜æ»¡        | æ‰©å®¹/è®¾ç½®è¿‡æœŸæ—¶é—´           |

---

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡é€ŸæŸ¥

### Flink Web UI (8081ç«¯å£)

| é¡µé¢             | å…³æ³¨æŒ‡æ ‡                         |
| ---------------- | -------------------------------- |
| **Overview**     | TaskManageræ•°é‡ã€æ§½ä½ä½¿ç”¨ç‡      |
| **Jobs**         | è¿è¡ŒçŠ¶æ€ã€è¿è¡Œæ—¶é•¿               |
| **Task Metrics** | Records/sã€Bytes/sã€Backpressure |
| **Checkpoints**  | æˆåŠŸç‡ã€è€—æ—¶ã€å¤§å°               |

### å…³é”® Metrics

| æŒ‡æ ‡                    | å«ä¹‰                | æ­£å¸¸èŒƒå›´      |
| ----------------------- | ------------------- | ------------- |
| **Throughput**          | ååé‡ï¼ˆrecords/sï¼‰ | æ ¹æ®ä¸šåŠ¡      |
| **Latency**             | ç«¯åˆ°ç«¯å»¶è¿Ÿ          | <100ms        |
| **Backpressure**        | åå‹ï¼ˆ0-1ï¼‰         | <0.5          |
| **Checkpoint Duration** | Checkpointè€—æ—¶      | <10s          |
| **State Size**          | çŠ¶æ€å¤§å°            | ç¨³å®šå¢é•¿/ç¨³å®š |

### è‡ªå®šä¹‰ Metrics ç¤ºä¾‹
```java
Counter processedOrders = metricGroup.counter("processed_orders");
Meter processingRate = metricGroup.meter("processing_rate", new MeterView(60));
Gauge stateSize = metricGroup.gauge("state_size", () -> getStateSize());
```

---

## ğŸ¯ é«˜é¢‘é¢è¯•é—®é¢˜é€ŸæŸ¥

### æ ¸å¿ƒé—®é¢˜ï¼ˆå¿…é—®ï¼‰

| é—®é¢˜               | å…³é”®è¯ç­”æ¡ˆ                                      |
| ------------------ | ----------------------------------------------- |
| **é¡¹ç›®ä»‹ç»**       | å®æ—¶é‡‘èæ•°æ®å¤„ç†ã€Flink+Kafka+Redisã€è®¢å•ç°¿ç»´æŠ¤ |
| **ä¸ºä»€ä¹ˆé€‰Flink**  | åŸç”Ÿæµå¤„ç†ã€MapStateã€ç²¾ç¡®ä¸€æ¬¡ã€ä½å»¶è¿Ÿ          |
| **è®¢å•ç°¿å¦‚ä½•ç»´æŠ¤** | KeyByåˆ†åŒºã€MapStateå­˜å‚¨ã€ä»·æ ¼åˆ†ç»„ã€å®šæ—¶è¾“å‡º     |
| **å¦‚ä½•ä¿è¯ä¸€è‡´æ€§** | Checkpointã€ç²¾ç¡®ä¸€æ¬¡è¯­ä¹‰ã€å¹‚ç­‰å†™å…¥              |
| **é‡åˆ°çš„æŒ‘æˆ˜**     | çŠ¶æ€è¿‡å¤§OOM â†’ ä»·æ ¼åˆ†ç»„+RocksDB                  |
| **æ€§èƒ½ä¼˜åŒ–**       | å¹¶è¡Œåº¦ã€å¼‚æ­¥IOã€çŠ¶æ€æ¸…ç†ã€æ•°æ®å€¾æ–œ              |
| **æ•…éšœå¤„ç†**       | é‡å¯ç­–ç•¥ã€é‡è¯•æœºåˆ¶ã€ç›‘æ§å‘Šè­¦                    |

### æŠ€æœ¯æ·±æŒ–ï¼ˆå¯èƒ½é—®ï¼‰

#### Flink State ç›¸å…³
- Stateç±»å‹æœ‰å“ªäº›ï¼Ÿï¼ˆ5ç§ï¼‰
- MapStateå¦‚ä½•ä½¿ç”¨ï¼Ÿï¼ˆget/put/remove/entriesï¼‰
- Stateå­˜å‚¨åœ¨å“ªï¼Ÿï¼ˆå†…å­˜/RocksDB/HDFSï¼‰
- State TTLæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆè‡ªåŠ¨æ¸…ç†è¿‡æœŸçŠ¶æ€ï¼‰

#### Checkpoint ç›¸å…³
- Checkpointæœºåˆ¶ï¼Ÿï¼ˆBarrierå¯¹é½ã€å¿«ç…§ã€æŒä¹…åŒ–ï¼‰
- å¦‚ä½•é…ç½®ï¼Ÿï¼ˆenableCheckpointingã€EXACTLY_ONCEï¼‰
- å¤±è´¥å¦‚ä½•æ¢å¤ï¼Ÿï¼ˆä»æœ€è¿‘Checkpointæ¢å¤çŠ¶æ€å’ŒOffsetï¼‰

#### Watermark ç›¸å…³
- æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå¤„ç†ä¹±åºæ•°æ®çš„æ—¶é—´æˆ³ï¼‰
- é¡¹ç›®ä¸­ç”¨äº†å—ï¼Ÿï¼ˆOrderbookJobæ²¡ç”¨ï¼ŒTickerJobåº”è¯¥ç”¨ï¼‰
- ä¸ºä»€ä¹ˆä¸ç”¨ï¼Ÿï¼ˆProcessingTime + å®šæ—¶å™¨ï¼Œç®€åŒ–é€»è¾‘ï¼‰

#### æ•°æ®å€¾æ–œ
- å¦‚ä½•è¯†åˆ«ï¼Ÿï¼ˆSubTaskå¤„ç†é‡å·®å¼‚å¤§ï¼‰
- å¦‚ä½•è§£å†³ï¼Ÿï¼ˆéšæœºå‰ç¼€ã€è‡ªå®šä¹‰åˆ†åŒºã€åˆ†æµå¤„ç†ï¼‰

---

## ğŸ“ ä»£ç é¢è¯•é€ŸæŸ¥

### æ‰‹å†™ä»£ç é¢˜å¯èƒ½æ–¹å‘

#### 1. å®ç°ç®€å•çš„ MapState æ“ä½œ
```java
public class SimpleProcessor 
    extends KeyedProcessFunction<String, Event, Result> {
    
    private MapState<String, Long> countState;

    @Override
    public void open(Configuration parameters) {
        countState = getRuntimeContext().getMapState(
            new MapStateDescriptor<>("counts", String.class, Long.class));
    }

    @Override
    public void processElement(Event event, Context ctx, Collector<Result> out) 
        throws Exception {
        String key = event.getKey();
        Long count = countState.get(key);
        count = (count == null) ? 1L : count + 1L;
        countState.put(key, count);
        
        out.collect(new Result(key, count));
    }
}
```

#### 2. å®ç°å»é‡é€»è¾‘
```java
public class DeduplicateProcessor 
    extends KeyedProcessFunction<String, Event, Event> {
    
    private ValueState<Set<String>> seenIdsState;

    @Override
    public void open(Configuration parameters) {
        seenIdsState = getRuntimeContext().getState(
            new ValueStateDescriptor<>("seenIds", new SetTypeInfo<>(String.class)));
    }

    @Override
    public void processElement(Event event, Context ctx, Collector<Event> out) 
        throws Exception {
        Set<String> seenIds = seenIdsState.value();
        if (seenIds == null) {
            seenIds = new HashSet<>();
        }
        
        if (!seenIds.contains(event.getId())) {
            seenIds.add(event.getId());
            seenIdsState.update(seenIds);
            out.collect(event);
        }
    }
}
```

#### 3. å®ç°çª—å£èšåˆ
```java
DataStream<Event> stream = ...;
stream.keyBy(Event::getKey)
      .window(TumblingEventTimeWindows.of(Time.minutes(1)))
      .aggregate(new AggregateFunction<Event, Long, Long>() {
          @Override
          public Long createAccumulator() { return 0L; }
          
          @Override
          public Long add(Event event, Long acc) { return acc + 1; }
          
          @Override
          public Long getResult(Long acc) { return acc; }
          
          @Override
          public Long merge(Long acc1, Long acc2) { return acc1 + acc2; }
      });
```

---

## ğŸ“ å­¦ä¹ èµ„æºé€ŸæŸ¥

### å®˜æ–¹æ–‡æ¡£
- Flink å®˜ç½‘ï¼šhttps://flink.apache.org/
- Flink ä¸­æ–‡æ–‡æ¡£ï¼šhttps://flink.apache.org/zh/
- Kafka å®˜ç½‘ï¼šhttps://kafka.apache.org/

### æ¨èä¹¦ç±
- ã€ŠFlink å®æˆ˜ä¸æ€§èƒ½ä¼˜åŒ–ã€‹
- ã€Šæµå¼ç³»ç»Ÿã€‹ï¼ˆStreaming Systemsï¼‰
- ã€Šè®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨ã€‹ï¼ˆDDIAï¼‰

### ç¤¾åŒº
- Apache Flink ä¸­æ–‡ç¤¾åŒº
- Stack Overflow (tag: apache-flink)
- GitHub Discussions

---

## âš¡ å¿«é€Ÿè®°å¿†å£è¯€

### é¡¹ç›®æ¶æ„ï¼ˆ3-3-3ï¼‰
- **3å±‚æ¶æ„**ï¼šouterã€flinkã€common
- **3ä¸ªJob**ï¼šOrderbookã€Tickerã€Candle
- **3å¤§ç»„ä»¶**ï¼šFlinkã€Kafkaã€Redis

### Flink Stateï¼ˆMVLRAï¼‰
- **M**apState - Mapç»“æ„
- **V**alueState - å•å€¼
- **L**istState - åˆ—è¡¨
- **R**educingState - ç´¯åŠ 
- **A**ggregatingState - èšåˆ

### ä¼˜åŒ–æ‰‹æ®µï¼ˆå¹¶çŠ¶ç½‘é“¾å€¾å¼‚ï¼‰
- **å¹¶**è¡Œåº¦
- **çŠ¶**æ€ä¼˜åŒ–
- **ç½‘**ç»œä¼˜åŒ–
- **é“¾**å¼ä¼˜åŒ–
- æ•°æ®**å€¾**æ–œ
- **å¼‚**æ­¥IO

### æ’æŸ¥æµç¨‹ï¼ˆç°æ—¥å¡ä¸Šä¾ï¼‰
- ç¡®è®¤**ç°**è±¡
- æŸ¥çœ‹**æ—¥**å¿—
- æ£€æŸ¥**å¡**å¤«å¡
- æ£€æŸ¥**ä¸Š**æ¸¸ï¼ˆmarket-outerï¼‰
- æ£€æŸ¥**ä¾**èµ–ï¼ˆRedis/Zookeeperï¼‰

---

## ğŸ“ é¡¹ç›®è”ç³»æ–¹å¼é€ŸæŸ¥

### ç»„ä»¶ç«¯å£
- Flink Web UI: `http://localhost:8081`
- Flink RPC: `6123`
- Kafka: `localhost:9092`
- Zookeeper: `localhost:2181`
- Redis: `localhost:6379`
- market-outer: `http://localhost:10808`

### å¸¸ç”¨å‘½ä»¤
```bash
# å¯åŠ¨ Flink
$FLINK_HOME/bin/start-cluster.sh

# æäº¤ä½œä¸š
flink run -c com.ganten.market.flink.job.OrderbookJob market-flink.jar

# æŸ¥çœ‹ Kafka æ¶ˆè´¹è€…ç»„
kafka-consumer-groups.sh --describe --group orderbook --bootstrap-server localhost:9092

# Redis æŸ¥è¯¢
redis-cli GET orderbook:1:1

# æŸ¥çœ‹ Flink ä½œä¸šåˆ—è¡¨
flink list
```

---

## ğŸ’¡ é¢è¯•åŠ åˆ†é¡¹

### å±•ç¤ºæ€è€ƒæ·±åº¦
1. æå‡ºæ”¹è¿›å»ºè®®ï¼ˆå¼‚æ­¥IOã€å¢é‡è¾“å‡ºï¼‰
2. è®¨è®ºè¾¹ç•Œæƒ…å†µï¼ˆæ•°æ®ä¸¢å¤±ã€ä¹±åºï¼‰
3. å¯¹æ¯”ä¸åŒæ–¹æ¡ˆï¼ˆFlink vs Sparkã€Redis vs MySQLï¼‰

### å±•ç¤ºé¡¹ç›®ç†è§£
1. ç”»å‡ºæ¶æ„å›¾
2. è§£é‡Šå…³é”®ä»£ç 
3. åˆ†ææ€§èƒ½ç“¶é¢ˆ

### å±•ç¤ºæŠ€æœ¯å¹¿åº¦
1. æåŠç›‘æ§æ–¹æ¡ˆï¼ˆPrometheusã€Grafanaï¼‰
2. è®¨è®ºæ‰©å±•æ€§ï¼ˆæ°´å¹³æ‰©å±•ã€å¤šæ•°æ®ä¸­å¿ƒï¼‰
3. å…³æ³¨æˆæœ¬ä¼˜åŒ–ï¼ˆèµ„æºé…é¢ã€æŒ‰éœ€ä¼¸ç¼©ï¼‰

---

## âœ… é¢è¯•å‰æœ€åæ£€æŸ¥æ¸…å•

### æŠ€æœ¯å‡†å¤‡
- [ ] èƒ½æµç•…ä»‹ç»é¡¹ç›®ï¼ˆ3åˆ†é’Ÿç‰ˆæœ¬ï¼‰
- [ ] èƒ½æ‰‹ç”»æ¶æ„å›¾
- [ ] ç†Ÿæ‚‰ OrderBookProcessor æ ¸å¿ƒä»£ç 
- [ ] äº†è§£ Flink State å’Œ Checkpoint æœºåˆ¶
- [ ] å‡†å¤‡2-3ä¸ªæŠ€æœ¯éš¾ç‚¹æ•…äº‹ï¼ˆSTARæ³•åˆ™ï¼‰
- [ ] äº†è§£å¸¸è§æ•…éšœæ’æŸ¥æµç¨‹

### ç¯å¢ƒå‡†å¤‡
- [ ] é¡¹ç›®ä»£ç èƒ½æœ¬åœ°è¿è¡Œ
- [ ] å‡†å¤‡æ¶æ„å›¾PPT/ç™½æ¿è‰å›¾
- [ ] å‡†å¤‡ä»£ç ç‰‡æ®µï¼ˆGitHub Gistï¼‰
- [ ] å‡†å¤‡æ€§èƒ½æ•°æ®ï¼ˆå¦‚æœ‰ï¼‰

### å¿ƒæ€å‡†å¤‡
- [ ] è‡ªä¿¡ä½†ä¸å‚²æ…¢
- [ ] ä¸æ‡‚å°±è¯´ä¸æ‡‚ï¼Œä½†è¦è¯´å‡ºå­¦ä¹ è®¡åˆ’
- [ ] é¢è¯•æ˜¯åŒå‘é€‰æ‹©
- [ ] æ·±å‘¼å¸ï¼Œä¿æŒå†·é™

---

**ç›¸ä¿¡è‡ªå·±ï¼Œä½ ä¸€å®šå¯ä»¥çš„ï¼ğŸ‰**
